<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=yes">
    <title>æˆ‘çš„ Â· T-PACHIN å€‹äººä¸­å¿ƒ (äº¤æ˜“è¨˜éŒ„ä¸ååˆ)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
   <style>
    /* ========== æ‰€æœ‰æ¨£å¼å®Œå…¨ä¿ç•™ ========== */
    .tech-gradient { background: linear-gradient(180deg, #000814 0%, #001233 50%, #001845 100%); }
    .tech-border { border: 1px solid rgba(0, 148, 255, 0.4); }
    
    /* ... ä¸­é–“æœ‰å¾ˆå¤šåŸæœ¬çš„æ¨£å¼ ... */
    
    /* ========== å€’æ•¸ç¬¬äºŒå€‹æ¨£å¼ ========== */
    .category-section {
        margin-bottom: 2rem;
    }
    
    /* ===== åœ¨é€™è£¡åŠ å…¥å°ç´…é»æ¨£å¼ ===== */
    .nav-item {
        position: relative;
    }
    .nav-badge {
        position: absolute;
        top: 0px;
        right: 0px;
        width: 10px;
        height: 10px;
        background-color: #ff3b3b;
        border-radius: 50%;
        border: 2px solid #001a33;
        box-shadow: 0 0 8px #ff0000;
        display: none;
        z-index: 25;
    }
    .nav-item.current-page .nav-badge {
        border-color: #0066cc;
    }
</style>
        /* ===== å®Œæ•´æ¨£å¼è¡¨ ===== */
        .tech-gradient {
            background: linear-gradient(180deg, #000814 0%, #001233 50%, #001845 100%);
            transition: background 0.3s ease;
        }
        body.dark-mode .tech-gradient {
            background: linear-gradient(180deg, #1a2a3a 0%, #1f3a5f 50%, #2c4c6b 100%);
        }
        body.dark-mode .game-card-bg {
            background: linear-gradient(180deg, rgba(40, 70, 100, 0.8) 0%, rgba(20, 50, 80, 0.9) 100%);
        }
        body.dark-mode .filter-drawer {
            background: linear-gradient(165deg, #2a3f5a 0%, #1b2b40 100%);
        }
        body.dark-mode .bottom-nav {
            background: #2c4058;
            border-top-color: #3399ff;
        }
        
        .tech-border {
            border: 1px solid rgba(0, 148, 255, 0.4);
        }
        .game-card-bg {
            background: linear-gradient(180deg, rgba(0, 30, 60, 0.8) 0%, rgba(0, 15, 30, 0.9) 100%);
            transition: background 0.3s ease;
        }
        
        .filter-drawer {
            position: fixed;
            top: 0;
            right: -100%;
            width: 85%;
            max-width: 340px;
            height: 100vh;
            background: linear-gradient(165deg, #001a33 0%, #000a1a 100%);
            border-left: 2px solid #0099ff;
            box-shadow: -5px 0 30px rgba(0, 153, 255, 0.5);
            z-index: 10000;
            transition: right 0.3s ease;
            overflow-y: auto;
            padding: 1.5rem;
        }
        .filter-drawer.open {
            right: 0;
        }
        .drawer-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(3px);
            z-index: 9999;
            display: none;
        }
        .drawer-overlay.open {
            display: block;
        }
        
        .filter-chip {
            background: rgba(0, 40, 70, 0.8);
            border: 1px solid #0099ff60;
            border-radius: 9999px;
            padding: 0.4rem 1.2rem;
            font-size: 0.75rem;
            color: #cce6ff;
            transition: all 0.2s;
            cursor: pointer;
            display: inline-block;
        }
        
        .scrollbar-thin::-webkit-scrollbar {
            width: 4px;
            height: 4px;
        }
        .scrollbar-thin::-webkit-scrollbar-track {
            background: rgba(0, 20, 40, 0.5);
        }
        .scrollbar-thin::-webkit-scrollbar-thumb {
            background: #0099ff;
            border-radius: 4px;
        }

        .bottom-nav {
            background: #001a33;
            border-top: 2px solid #0066cc;
            box-shadow: 0 -2px 10px rgba(0, 102, 204, 0.3);
            width: 100%;
            max-width: 448px;
            padding: 0.75rem 1.5rem;
            margin-top: 1rem;
            transition: background 0.3s ease, border-top-color 0.3s ease;
        }
        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            color: #4b9cd3;
            transition: all 0.2s ease;
            border-radius: 8px;
            padding: 0.25rem 0.5rem;
            text-decoration: none;
            outline: none;
        }
        .nav-item:hover {
            color: #80e4ff;
            transform: translateY(-2px);
            text-shadow: 0 0 6px #00ccff;
            background: rgba(0, 153, 255, 0.15);
        }
        .nav-item:active {
            transform: scale(0.95);
            color: white;
            background: rgba(0, 204, 255, 0.3);
        }
        .nav-item.current-page {
            color: white;
            background: linear-gradient(90deg, #0066cc 0%, #0099ff 100%);
            border: 1px solid #80e4ff;
            box-shadow: 0 0 12px #00ccff;
            transform: scale(1.02);
        }
        
        .action-grid-btn {
            background: rgba(0, 30, 60, 0.8);
            border: 1px solid #0099ff60;
            border-radius: 16px;
            padding: 1rem 0.5rem;
            text-align: center;
            transition: all 0.2s;
            color: #cce6ff;
            font-size: 0.9rem;
            backdrop-filter: blur(4px);
            cursor: pointer;
            user-select: none;
            position: relative;
        }
        .action-grid-btn i {
            display: block;
            font-size: 1.8rem;
            margin-bottom: 6px;
            color: #ffd966;
        }
        .action-grid-btn:active {
            transform: scale(0.94);
            background: #0099ff60;
            border-color: #00ccff;
            box-shadow: 0 0 12px #00ccff;
        }
        
        .count-badge {
            position: absolute;
            top: 8px;
            right: 12px;
            background: #ff4444;
            color: white;
            font-size: 0.7rem;
            font-weight: bold;
            min-width: 22px;
            height: 22px;
            border-radius: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 0 6px;
            border: 1px solid #ffd966;
            box-shadow: 0 0 8px #ff4444;
            animation: pulse 2s infinite;
        }
        .count-badge.keep {
            background: #ff9900;
            box-shadow: 0 0 8px #ff9900;
        }
        @keyframes pulse {
            0% { opacity: 0.9; transform: scale(1); }
            50% { opacity: 1; transform: scale(1.1); }
            100% { opacity: 0.9; transform: scale(1); }
        }

        .machine-card {
            background: rgba(0, 40, 70, 0.7);
            border: 1px solid #0099ff60;
            border-radius: 12px;
            padding: 0.8rem;
            display: flex;
            gap: 12px;
            align-items: center;
            transition: 0.2s;
            backdrop-filter: blur(4px);
            position: relative;
        }
        .machine-card:active {
            transform: scale(0.98);
            background: #0099ff30;
        }
        .machine-card img {
            width: 60px;
            height: 60px;
            border-radius: 10px;
            object-fit: cover;
            border: 1px solid #0099ff;
        }
        .machine-info {
            flex: 1;
        }
        .machine-name {
            font-weight: bold;
            color: #ffd966;
            font-size: 1rem;
        }
        .machine-meta {
            display: flex;
            gap: 8px;
            margin-top: 4px;
            font-size: 0.7rem;
            color: #b0d4ff;
        }
        .machine-meta span {
            background: rgba(0, 153, 255, 0.2);
            padding: 0.2rem 0.6rem;
            border-radius: 30px;
            border: 1px solid #0099ff40;
        }
        
        .countdown-timer {
            font-size: 0.7rem;
            color: #ffaa00;
            background: rgba(0, 0, 0, 0.4);
            padding: 0.2rem 0.6rem;
            border-radius: 30px;
            border: 1px solid #ffaa00;
            display: inline-flex;
            align-items: center;
            gap: 4px;
            margin-top: 6px;
            width: fit-content;
        }
        .countdown-timer i {
            color: #ffaa00;
            font-size: 0.6rem;
        }
        .countdown-timer.warning {
            color: #ff6666;
            border-color: #ff6666;
            animation: blink 1s infinite;
        }
        .countdown-timer.warning i {
            color: #ff6666;
        }
        @keyframes blink {
            0% { opacity: 1; }
            50% { opacity: 0.6; }
            100% { opacity: 1; }
        }

        .machine-actions {
            display: flex;
            flex-direction: column;
            gap: 6px;
            margin-left: 4px;
        }
        .play-btn {
            background: linear-gradient(135deg, #00cc66, #009933);
            border: 1px solid #80ff80;
            color: white;
            font-size: 0.7rem;
            padding: 4px 10px;
            border-radius: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 4px;
            cursor: pointer;
            box-shadow: 0 0 8px #00ff80;
            transition: 0.15s;
            white-space: nowrap;
        }
        .play-btn:active {
            transform: scale(0.9);
            background: #00ff80;
            color: #000;
        }
        .play-btn i {
            font-size: 0.7rem;
        }
        
        .remove-btn {
            color: #ff6666;
            font-size: 1rem;
            padding: 4px 8px;
            cursor: pointer;
            text-align: center;
            background: rgba(255, 0, 0, 0.1);
            border-radius: 30px;
            border: 1px solid #ff6666;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 4px;
        }
        .remove-btn:active {
            transform: scale(0.9);
            background: #ff0000;
            color: white;
        }

        .machine-list-container {
            margin-top: 1rem;
            display: none;
        }
        .machine-list-container.show {
            display: block;
        }
        .machine-list {
            display: flex;
            flex-direction: column;
            gap: 10px;
            max-height: 350px;
            overflow-y: auto;
            padding-right: 4px;
        }
        .list-title {
            color: #80e4ff;
            font-size: 0.9rem;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .nickname-edit {
            cursor: pointer;
            transition: 0.1s;
            border-bottom: 1px dashed #aaa;
        }
        .home-return-btn {
            background: rgba(0, 153, 255, 0.25);
            border: 1.5px solid #80e4ff;
            color: #ffd966;
            width: 44px;
            height: 44px;
            border-radius: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.6rem;
            box-shadow: 0 0 12px #00aaff;
            backdrop-filter: blur(4px);
            transition: 0.15s;
            text-decoration: none;
        }
        .avatar-container {
            position: relative;
            width: 70px;
            height: 70px;
            border-radius: 9999px;
            border: 3px solid #0099ff;
            box-shadow: 0 0 15px #00ccff;
            background: #001d3d;
            overflow: hidden;
            cursor: pointer;
        }
        .avatar-container img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        .avatar-overlay {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(0, 100, 200, 0.8);
            color: white;
            font-size: 0.7rem;
            text-align: center;
            padding: 3px 0;
            backdrop-filter: blur(2px);
        }
        .profile-tab {
            flex: 1;
            text-align: center;
            padding: 0.7rem 0;
            border-radius: 40px;
            background: transparent;
            border: 1px solid #0099ff40;
            color: #b0d4ff;
            font-weight: 500;
            transition: 0.2s;
            cursor: pointer;
        }
        .profile-tab.active {
            background: #0066cc;
            border-color: #80e4ff;
            color: white;
            box-shadow: 0 0 10px #00ccff;
        }
        .lang-select {
            background: rgba(0, 30, 60, 0.9);
            border: 1px solid #0099ff;
            border-radius: 40px;
            padding: 0.6rem 2rem 0.6rem 1.2rem;
            font-size: 0.9rem;
            color: #e0f0ff;
            width: 100%;
            appearance: none;
            background-image: url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%230099ff' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'><polyline points='6 9 12 15 18 9'/></svg>");
            background-repeat: no-repeat;
            background-position: right 0.8rem center;
            background-size: 1.2rem;
            cursor: pointer;
        }
        .theme-switch {
            width: 48px;
            height: 24px;
            background-color: #1e3a5f;
            border-radius: 40px;
            border: 1px solid #0099ff;
            position: relative;
            cursor: pointer;
        }
        .theme-switch .thumb {
            width: 20px;
            height: 20px;
            background-color: #ffd966;
            border-radius: 50%;
            position: absolute;
            top: 1px;
            left: 2px;
            transition: left 0.2s;
        }
        body.dark-mode .theme-switch .thumb {
            left: 26px;
            background-color: #cce6ff;
        }
        .vip-badge {
            background: linear-gradient(135deg, #b8860b, #ffd700);
            color: #000;
            font-weight: bold;
            padding: 0.15rem 0.6rem;
            border-radius: 30px;
            font-size: 0.7rem;
            box-shadow: 0 0 8px #ffaa00;
            cursor: pointer;
        }
        .exp-text {
            font-size: 0.7rem;
            color: #b0d4ff;
            cursor: pointer;
        }
        .progress-bar {
            width: 100%;
            height: 6px;
            background: rgba(0, 50, 100, 0.5);
            border-radius: 10px;
            overflow: hidden;
            border: 1px solid #0099ff60;
        }
        .progress-fill {
            height: 100%;
            width: 68%;
            background: linear-gradient(90deg, #ffd966, #ffaa33);
            border-radius: 10px;
        }
        .vip-info-panel {
            background: rgba(0, 20, 40, 0.95);
            border: 2px solid #ffd966;
            border-radius: 16px;
            padding: 1rem;
            margin: 0.5rem 0;
            box-shadow: 0 0 20px #ffaa33;
            backdrop-filter: blur(8px);
            display: none;
        }
        .vip-info-panel.show {
            display: block;
        }
        .vip-tier {
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid #0099ff60;
            padding: 0.5rem 0;
        }
        .banner-area {
            width: 100%;
            height: auto;
            background: linear-gradient(145deg, #002244, #001133);
            border: 1px solid #0099ff60;
            border-radius: 12px;
            padding: 0.75rem 0.5rem;
        }
        .sub-tab {
            background: rgba(0, 30, 60, 0.5);
            border: 1px solid #0099ff40;
            border-radius: 30px;
            padding: 0.3rem 1rem;
            font-size: 0.75rem;
            color: #b0d4ff;
            cursor: pointer;
            transition: 0.2s;
            text-align: center;
        }
        .sub-tab.active {
            background: #0066cc;
            border-color: #80e4ff;
            color: white;
            box-shadow: 0 0 6px #00ccff;
        }
        .bet-id {
            font-size: 0.9rem;
            font-weight: 600;
            color: #aad0ff;
            letter-spacing: 0.5px;
        }
        .detail-bb {
            color: #ffaa33;
            font-weight: bold;
            border-bottom: 1px dashed #ffaa33;
            cursor: pointer;
            font-size: 0.8rem;
            margin-left: 6px;
            white-space: nowrap;
        }
        .pagination {
            display: flex;
            justify-content: center;
            gap: 8px;
            margin-top: 16px;
            flex-wrap: wrap;
        }
        .page-btn {
            background: rgba(0, 40, 70, 0.8);
            border: 1px solid #0099ff60;
            border-radius: 30px;
            padding: 0.3rem 0.8rem;
            font-size: 0.8rem;
            color: #cce6ff;
            cursor: pointer;
            transition: 0.2s;
            min-width: 36px;
            text-align: center;
        }
        .page-btn.active {
            background: #0066cc;
            border-color: #80e4ff;
            color: white;
            box-shadow: 0 0 6px #00ccff;
        }
        .page-btn:active {
            transform: scale(0.92);
        }
        
        .platform-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid #1f4a7a;
            padding: 10px 0;
            font-size: 0.85rem;
            cursor: pointer;
            transition: 0.2s;
            border-radius: 8px;
            padding-left: 6px;
            position: relative;
        }
        .platform-item:hover {
            background: rgba(0, 153, 255, 0.15);
        }
        .platform-item .chevron-icon {
            transition: transform 0.2s;
        }
        .platform-item.expanded .chevron-icon {
            transform: rotate(90deg);
        }
        .platform-left {
            display: flex;
            align-items: center;
            gap: 8px;
            flex-wrap: wrap;
        }
        .platform-tag {
            font-weight: bold;
            padding: 2px 8px;
            border-radius: 20px;
            font-size: 0.7rem;
            min-width: 45px;
            text-align: center;
        }
        .platform-tag.out {
            background: #00a86b20;
            border: 1px solid #00cc88;
            color: #a0ffc0;
        }
        .platform-tag.in {
            background: #cc555020;
            border: 1px solid #ff6666;
            color: #ffb0b0;
        }
        .platform-machine {
            color: #ffd966;
            background: rgba(0, 153, 255, 0.15);
            border-radius: 16px;
            padding: 0.1rem 0.6rem;
            font-size: 0.75rem;
            font-weight: 500;
        }
        .platform-amount {
            font-weight: 600;
            margin-left: auto;
            padding-right: 8px;
        }
        .platform-detail {
            background: rgba(0, 20, 40, 0.9);
            border-left: 3px solid #0099ff;
            border-radius: 0 0 12px 12px;
            padding: 12px 15px;
            margin-top: 8px;
            margin-bottom: 8px;
            font-size: 0.85rem;
            display: none;
        }
        .platform-item.expanded + .platform-detail {
            display: block;
        }
        .platform-detail-row {
            display: flex;
            justify-content: space-between;
            margin: 6px 0;
        }
        .platform-detail-label {
            color: #aaccff;
        }
        .platform-detail-value {
            font-weight: 600;
            color: #ffd966;
        }
        .platform-detail-change {
            font-weight: 600;
        }
        .platform-detail-change.positive { color: #88ff88; }
        .platform-detail-change.negative { color: #ff8888; }
        
        .filter-row {
            display: flex;
            gap: 8px;
            margin: 10px 0 15px 0;
            flex-wrap: wrap;
        }
        .filter-select, .filter-date {
            background: #003366 !important;
            border: 2px solid #66ccff !important;
            border-radius: 30px;
            padding: 0.4rem 1rem;
            font-size: 0.8rem;
            color: #ffffff !important;
            cursor: pointer;
            flex: 1 1 auto;
            font-weight: 500;
            box-shadow: 0 0 8px #3399ff;
        }
        .filter-date {
            min-width: 130px;
        }
        .filter-select option {
            background: #004488;
            color: white;
        }
        input[type="date"]::-webkit-calendar-picker-indicator {
            filter: invert(1);
            opacity: 0.8;
            cursor: pointer;
        }
        input[type="date"]::-webkit-calendar-picker-indicator:hover {
            opacity: 1;
        }
        
        .current-balance {
            background: rgba(0, 153, 255, 0.15);
            border-radius: 30px;
            padding: 0.5rem 1rem;
            margin-bottom: 15px;
            border: 1px solid #0099ff60;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .balance-number {
            font-size: 1.2rem;
            font-weight: bold;
            color: #ffd966;
            text-shadow: 0 0 5px #ffaa00;
        }
        .formula-box {
            background: rgba(0, 20, 40, 0.7);
            border: 1px solid #0099ff60;
            border-radius: 16px;
            padding: 10px;
            margin-bottom: 15px;
            text-align: center;
            font-size: 0.8rem;
            line-height: 1.5;
        }
        .formula-highlight {
            color: #ffd966;
            font-weight: bold;
            font-size: 0.9rem;
        }
        
        /* çµ±ä¸€å€å¡Šæ¨£å¼ (åƒ…ç”¨æ–¼å…Œæ›ä¾†æº) */
        .uniform-section {
            margin-bottom: 8px;
        }
        .uniform-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            background: rgba(0, 50, 80, 0.6);
            border: 1px solid #0099ff60;
            border-radius: 30px;
            padding: 10px 15px;
            cursor: pointer;
            transition: 0.2s;
        }
        .uniform-header:hover {
            background: rgba(0, 80, 120, 0.8);
        }
        .uniform-header .chevron {
            transition: transform 0.3s;
        }
        .uniform-header.collapsed .chevron {
            transform: rotate(-90deg);
        }
        .uniform-header-left {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .uniform-title {
            font-size: 0.95rem;
            font-weight: 500;
        }
        .uniform-content {
            transition: all 0.3s;
            overflow: hidden;
            padding: 5px 0;
        }
        .uniform-content.collapsed {
            display: none;
        }
        
        /* äº¤æ˜“è¨˜éŒ„åˆ—è¡¨æ¨™é¡Œ - ç´”æ–‡å­—ä¸ååˆ */
        .records-title {
            font-size: 0.95rem;
            font-weight: 500;
            color: #b0d4ff;
            margin: 15px 0 10px 0;
            padding-left: 5px;
            border-left: 3px solid #0099ff;
            padding-left: 10px;
        }
        
        .source-detail-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 15px;
            border-bottom: 1px solid #1f4a7a;
            font-size: 0.85rem;
            background: rgba(0, 30, 50, 0.4);
        }
        .source-detail-item:last-child {
            border-bottom: none;
        }
        .source-detail-date {
            color: #aaccff;
        }
        .source-detail-amount {
            font-weight: 600;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-gray-900 to-blue-950 text-white">
    <!-- ç¯©é¸å´æ‹‰æ¬„ -->
    <div id="drawerOverlay" class="drawer-overlay"></div>
    <div id="filterDrawer" class="filter-drawer scrollbar-thin">
        <div class="flex justify-between items-center mb-6">
            <h3 class="text-primary text-lg font-bold flex items-center gap-2"><i class="fa fa-sliders text-secondary"></i> é€²éšç¯©é¸</h3>
            <button id="closeDrawer" class="text-gray-400 hover:text-primary text-2xl"><i class="fa fa-times-circle"></i></button>
        </div>
    </div>

    <!-- ä¸»å…§å®¹ -->
    <div class="max-w-md mx-auto tech-gradient min-h-screen flex flex-col">

        <!-- ========= é ‚éƒ¨å°èˆª ========= -->
        <header class="px-4 py-3 bg-dark-200/90 tech-border">
            <div class="flex items-center justify-between">
                <div class="flex items-center gap-3">
                    <div class="avatar-container" id="avatarContainer">
                        <img id="avatarImage" src="https://i.pravatar.cc/150?img=7" alt="user avatar">
                        <div class="avatar-overlay">æ›´æ›</div>
                    </div>
                    <div class="flex flex-col">
                        <div class="flex items-center gap-1" id="nicknameEditBlock">
                            <span id="displayNickname" class="nickname-edit text-white text-xl font-bold">å¤«äººæœƒç”Ÿæ°£</span>
                            <i class="fa fa-pencil-square-o text-blue-400 text-sm ml-1"></i>
                        </div>
                        <div class="flex items-center gap-2 mt-1">
                            <span class="vip-badge" id="vipBadge">VIP 3</span>
                            <span class="exp-text" id="expText">ç¶“é©—å€¼ 2,480/3,600</span>
                        </div>
                    </div>
                </div>
                <a href="#" id="exitToHomeBtn" class="home-return-btn" title="å›åˆ°é¦–é ">
                    <i class="fa fa-home"></i>
                </a>
            </div>
            <div class="mt-2 pl-16 pr-2">
                <div class="progress-bar"><div class="progress-fill"></div></div>
            </div>
        </header>

        <!-- VIP åŠŸèƒ½èªªæ˜æµ®å±¤ -->
        <div id="vipInfoPanel" class="vip-info-panel mx-4 mt-2">
            <h3 class="text-amber-400 font-bold text-sm mb-2"><i class="fa fa-crown"></i> VIP ç‰¹æ¬Šèªªæ˜</h3>
            <div class="vip-tier"><span class="level">VIP 1</span><span class="benefit">æ¯æ—¥ç´…åˆ© +50</span></div>
            <div class="vip-tier"><span class="level">VIP 2</span><span class="benefit">ä¿ç•™æ©Ÿå° +2 å°</span></div>
            <div class="vip-tier"><span class="level">VIP 3 (ç•¶å‰)</span><span class="benefit">è¿”æ°´ 0.5% + å°ˆå±¬å®¢æœ</span></div>
            <div class="vip-tier"><span class="level">VIP 4</span><span class="benefit">ç”Ÿæ—¥ç¦®é‡‘ 1000</span></div>
            <div class="vip-tier"><span class="level">VIP 5</span><span class="benefit">æé ˜æ‰‹çºŒè²»å…¨å…</span></div>
        </div>

        <!-- ä¸‰å¤§åŠŸèƒ½æŒ‰éˆ•å€ -->
        <div class="px-4 mt-4">
            <div class="banner-area grid grid-cols-3 gap-2 items-center">
                <div class="action-grid-btn" id="favMachinesBtn">
                    <span class="count-badge" id="favCount">3</span>
                    <i class="fa fa-heart" style="color: #ff6680;"></i>
                    <span class="text-xs block mt-1">æˆ‘æ”¶è—çš„æ©Ÿå°</span>
                </div>
                <div class="action-grid-btn" id="keepMachinesBtn">
                    <span class="count-badge keep" id="keepCount">2</span>
                    <i class="fa fa-bookmark" style="color: #ffb347;"></i>
                    <span class="text-xs block mt-1">æˆ‘ä¿ç•™çš„æ©Ÿå°</span>
                </div>
                <div class="action-grid-btn" id="supportBtn">
                    <i class="fa fa-headphones" style="color: #7ec8ff;"></i>
                    <span class="text-xs block mt-1">å®¢æœèˆ‡å¹«åŠ©</span>
                </div>
            </div>
        </div>

        <!-- æ”¶è—æ©Ÿå°åˆ—è¡¨å®¹å™¨ -->
        <div id="favMachineList" class="machine-list-container px-4">
            <div class="list-title"><i class="fa fa-heart text-pink-400"></i> æˆ‘æ”¶è—çš„æ©Ÿå° (<span id="favCountDisplay">3</span>)</div>
            <div class="machine-list" id="favMachineItems"></div>
        </div>

        <!-- ä¿ç•™æ©Ÿå°åˆ—è¡¨å®¹å™¨ -->
        <div id="keepMachineList" class="machine-list-container px-4">
            <div class="list-title"><i class="fa fa-bookmark text-amber-400"></i> æˆ‘ä¿ç•™çš„æ©Ÿå° (<span id="keepCountDisplay">2</span>)</div>
            <div class="machine-list" id="keepMachineItems"></div>
        </div>

        <!-- è·‘é¦¬ç‡ˆ -->
        <div class="px-4 py-1 bg-dark-200/80 tech-border mt-3">
            <marquee class="text-secondary text-xs py-1" scrollamount="5">âš™ï¸ äº¤æ˜“è¨˜éŒ„åˆ—è¡¨æ”¹ç‚ºç´”æ–‡å­—æ¨™é¡Œ | é»æ“Šè¨˜éŒ„å±•é–‹æ˜ç´° âš™ï¸</marquee>
        </div>

        <!-- æ¨™ç±¤æ¬„ -->
        <div class="px-4 py-3">
            <div class="flex gap-2" id="profileTabContainer">
                <button class="profile-tab active" data-tab="settings">âš™ï¸ è¨­å®š</button>
                <button class="profile-tab" data-tab="token">ğŸ’° ä»£å¹£</button>
                <button class="profile-tab" data-tab="betHistory">ğŸ“‹ æ³¨å–®ç´€éŒ„</button>
            </div>
        </div>

        <!-- å‹•æ…‹å…§å®¹å€åŸŸ -->
        <main class="flex-1 px-4 pb-4 overflow-y-auto scrollbar-thin" id="profileContentArea">
            <!-- è¨­å®šé¢æ¿ -->
            <div id="settingsPanel" class="tab-panel">
                <div class="game-card-bg tech-border rounded-xl p-4 space-y-4">
                    <h3 class="text-primary text-md border-b border-primary/20 pb-2"><i class="fa fa-cog mr-2"></i>åå¥½è¨­å®š</h3>
                    <div>
                        <div class="text-sm text-gray-300 mb-2">èªè¨€ / Language</div>
                        <select id="languageSelect" class="lang-select">
                            <option value="zh-hant" selected>ç¹é«”ä¸­æ–‡</option>
                            <option value="zh-hans">ç°¡é«”ä¸­æ–‡</option>
                            <option value="ja">æ—¥æœ¬èª</option>
                            <option value="ko">í•œêµ­ì–´</option>
                            <option value="en">English</option>
                        </select>
                    </div>
                    <div class="flex items-center justify-between">
                        <span class="text-sm text-gray-300">æ¥æ”¶é€šçŸ¥</span>
                        <div class="w-12 h-6 bg-blue-800 rounded-full flex items-center p-1 border border-blue-400">
                            <div class="w-4 h-4 bg-blue-300 rounded-full ml-auto shadow"></div>
                        </div>
                    </div>
                    <div class="flex items-center justify-between">
                        <span class="text-sm text-gray-300">æš—è‰²æ¨¡å¼</span>
                        <div id="themeToggle" class="theme-switch"><div class="thumb"></div></div>
                    </div>
                    <div class="flex items-center justify-between">
                        <span class="text-sm text-gray-300">å¸³è™Ÿç¶å®š</span>
                        <span class="text-xs text-green-400">å·²ç¶å®šæ‰‹æ©Ÿ</span>
                    </div>
                </div>
            </div>

            <!-- ä»£å¹£é¢æ¿ -->
            <div id="tokenPanel" class="tab-panel hidden">
                <div class="game-card-bg tech-border rounded-xl p-3">
                    <div class="flex gap-2 mb-3 border-b border-blue-900 pb-2">
                        <span class="sub-tab active" id="tokenExchangeSub">å…Œæ›</span>
                        <span class="sub-tab" id="tokenPlatformSub">å¹³å°å¸¶å‡ºå¸¶å…¥</span>
                    </div>
                    <!-- å…Œæ›å…§å®¹ - ä¸‰ç¨®ä¾†æº (ä¿ç•™æ”¶åˆ) -->
                    <div id="exchangeContent">
                        <h3 class="text-primary text-md mb-3"><i class="fa fa-gift mr-2"></i>ä»£å¹£ä¾†æº</h3>
                        
                        <!-- å„²å€¼å€å¡Š -->
                        <div class="uniform-section">
                            <div class="uniform-header" id="toggleRecharge">
                                <div class="uniform-header-left">
                                    <i class="fa fa-credit-card text-green-400"></i>
                                    <span class="uniform-title">å„²å€¼</span>
                                </div>
                                <div style="display: flex; align-items: center; gap: 10px;">
                                    <span class="uniform-value" id="rechargeAmount">3,000</span>
                                    <i class="fa fa-chevron-down chevron"></i>
                                </div>
                            </div>
                            <div class="uniform-content" id="rechargeDetails">
                                <div class="source-detail-item">
                                    <span class="source-detail-date">2025-02-15 14:30</span>
                                    <span class="source-detail-amount text-green-400">+1,000</span>
                                </div>
                                <div class="source-detail-item">
                                    <span class="source-detail-date">2025-02-10 09:20</span>
                                    <span class="source-detail-amount text-green-400">+2,000</span>
                                </div>
                                <div class="source-detail-item" onclick="alert('æ›´å¤šå„²å€¼è¨˜éŒ„...')" style="cursor: pointer; color: #66ccff; justify-content: center;">
                                    <span>æŸ¥çœ‹å®Œæ•´è¨˜éŒ„ <i class="fa fa-arrow-right ml-1"></i></span>
                                </div>
                            </div>
                        </div>
                        
                        <!-- å¹³å°è´ˆé€å€å¡Š -->
                        <div class="uniform-section">
                            <div class="uniform-header" id="toggleBonus">
                                <div class="uniform-header-left">
                                    <i class="fa fa-gift text-yellow-400"></i>
                                    <span class="uniform-title">å¹³å°è´ˆé€</span>
                                </div>
                                <div style="display: flex; align-items: center; gap: 10px;">
                                    <span class="uniform-value" id="bonusAmount">2,000</span>
                                    <i class="fa fa-chevron-down chevron"></i>
                                </div>
                            </div>
                            <div class="uniform-content" id="bonusDetails">
                                <div class="source-detail-item">
                                    <span class="source-detail-date">2025-02-18 10:15</span>
                                    <span class="source-detail-amount text-green-400">+500</span>
                                    <span class="text-xs text-blue-300">(è¨»å†Šç¦®)</span>
                                </div>
                                <div class="source-detail-item">
                                    <span class="source-detail-date">2025-02-20 16:40</span>
                                    <span class="source-detail-amount text-green-400">+1,000</span>
                                    <span class="text-xs text-blue-300">(å„²å€¼å›é¥‹)</span>
                                </div>
                                <div class="source-detail-item">
                                    <span class="source-detail-date">2025-02-25 09:30</span>
                                    <span class="source-detail-amount text-green-400">+500</span>
                                    <span class="text-xs text-blue-300">(æ¯æ—¥ç´…åˆ©)</span>
                                </div>
                            </div>
                        </div>
                        
                        <!-- éŠæˆ²è£¡ç²å¾—å€å¡Š -->
                        <div class="uniform-section">
                            <div class="uniform-header" id="toggleGame">
                                <div class="uniform-header-left">
                                    <i class="fa fa-gamepad text-purple-400"></i>
                                    <span class="uniform-title">éŠæˆ²è£¡ç²å¾—</span>
                                </div>
                                <div style="display: flex; align-items: center; gap: 10px;">
                                    <span class="uniform-value" id="gameAmount">1,740</span>
                                    <i class="fa fa-chevron-down chevron"></i>
                                </div>
                            </div>
                            <div class="uniform-content" id="gameDetails">
                                <div class="source-detail-item">
                                    <span class="source-detail-date">2025-02-16 20:30</span>
                                    <span class="source-detail-amount text-green-400">+800</span>
                                    <span class="text-xs text-blue-300">(ç”²è³€å¿æ³•å¸–)</span>
                                </div>
                                <div class="source-detail-item">
                                    <span class="source-detail-date">2025-02-19 22:15</span>
                                    <span class="source-detail-amount text-green-400">+640</span>
                                    <span class="text-xs text-blue-300">(è¶…ç´šå¥‡è¹Ÿå°ä¸‘)</span>
                                </div>
                                <div class="source-detail-item">
                                    <span class="source-detail-date">2025-02-22 19:40</span>
                                    <span class="source-detail-amount text-green-400">+300</span>
                                    <span class="text-xs text-blue-300">(å‰å®—)</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="mt-3 pt-2 border-t border-blue-800 text-xs text-blue-300 text-right">
                            <span class="mr-2">ç¸½ç²å¾—ä»£å¹£:</span>
                            <span class="text-amber-400 font-bold" id="totalSourceDisplay">6,740</span>
                        </div>
                    </div>
                    
                    <!-- å¹³å°å¸¶å‡ºå¸¶å…¥å…§å®¹ - äº¤æ˜“è¨˜éŒ„åˆ—è¡¨æ”¹ç‚ºç´”æ–‡å­—æ¨™é¡Œ -->
                    <div id="platformContent" class="hidden">
                        <h3 class="text-primary text-md"><i class="fa fa-arrows-h mr-2"></i>å¹³å°å¸¶å‡º/å¸¶å…¥</h3>
                        
                        <div class="current-balance">
                            <span>ğŸ’° ç•¶å‰èº«ä¸Šä»£å¹£</span>
                            <span class="balance-number" id="currentTokenBalance">5,520</span>
                        </div>
                        
                        <!-- å…¬å¼å€å¡Š -->
                        <div class="formula-box">
                            <div class="text-blue-300 mb-1 text-xs">è¨ˆç®—å…¬å¼ï¼š</div>
                            <div class="formula-highlight">ç¸½ç²å¾— 6,740 + (å¸¶å‡º+ 2,000) - (å¸¶å…¥- 780) = 5,520</div>
                            <div class="text-xs text-blue-300 mt-2">
                                <span class="text-green-400">å¸¶å‡º+</span> = å¾å¹³å°æå‡ºçš„ç¸½é¡ (2,000)<br>
                                <span class="text-red-400">å¸¶å…¥-</span> = å­˜å…¥å¹³å°çš„ç¸½é¡ (780)
                            </div>
                        </div>

                        <!-- æ˜é¡¯é¡è‰²çš„ç¯©é¸åˆ— -->
                        <div class="filter-row">
                            <input type="date" id="startDateFilter" class="filter-date" value="2025-01-01">
                            <span class="text-blue-300">è‡³</span>
                            <input type="date" id="endDateFilter" class="filter-date" value="2025-04-01">
                            <select id="platformFilter" class="filter-select">
                                <option value="all">å…¨éƒ¨</option>
                                <option value="out">åƒ…å¸¶å‡º (+)</option>
                                <option value="in">åƒ…å¸¶å…¥ (-)</option>
                            </select>
                        </div>

                        <!-- ç´”æ–‡å­—æ¨™é¡Œ - ä¸ååˆ -->
                        <div class="records-title">
                            <i class="fa fa-list-ul text-blue-400 mr-2"></i>äº¤æ˜“è¨˜éŒ„åˆ—è¡¨
                        </div>
                        
                        <div id="platformList" class="mt-1"></div>
                        <div id="platformPagination" class="pagination mt-3"></div>
                        
                        <div class="text-xs text-blue-300 mt-2 text-center">* é»æ“Šä»»ä¸€ç­†è¨˜éŒ„å±•é–‹æŸ¥çœ‹è©³ç´°è¨ˆç®—</div>
                    </div>
                </div>
            </div>

            <!-- æ³¨å–®ç´€éŒ„é¢æ¿ (ä¿ç•™æ”¶åˆ) -->
            <div id="betHistoryPanel" class="tab-panel hidden">
                <div class="game-card-bg tech-border rounded-xl p-3">
                    <h3 class="text-primary text-md"><i class="fa fa-list-alt mr-2"></i>æœ€è¿‘æ³¨å–®</h3>
                    
                    <div class="uniform-section">
                        <div class="uniform-header" id="toggleBetBtn">
                            <div class="uniform-header-left">
                                <i class="fa fa-list-ul text-blue-400"></i>
                                <span class="uniform-title">æ³¨å–®è¨˜éŒ„åˆ—è¡¨</span>
                            </div>
                            <i class="fa fa-chevron-down chevron"></i>
                        </div>
                        <div class="uniform-content" id="betSection">
                            <div id="betListContainer" class="mt-2 space-y-2 text-xs min-h-[180px]"></div>
                            <div id="betPagination" class="pagination mt-3">
                                <span class="page-btn active" data-page="1">1</span>
                                <span class="page-btn" data-page="2">2</span>
                                <span class="page-btn" data-page="3">3</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <!-- åº•éƒ¨å¯¼èˆª -->
<nav class="bottom-nav">
    <div class="flex justify-between items-center">
        <a href="https://col1688888-star.github.io/T-PACHIN/index.html" class="nav-item" id="nav-home" data-page="home">
            <i class="fa fa-home text-xl"></i>
            <span class="text-xs mt-1">é¦–é¡µ</span>
        </a>
        <a href="https://col1688888-star.github.io/T-PACHIN/machines.html" class="nav-item" id="nav-game" data-page="game">
            <i class="fa fa-gamepad text-xl"></i>
            <span class="text-xs mt-1">åå°</span>
        </a>
        <a href="https://col1688888-star.github.io/T-PACHIN/news.html" class="nav-item" id="nav-bell" data-page="bell">
            <i class="fa fa-bell text-xl"></i>
            <span class="text-xs mt-1">å…¬å‘Š</span>
            <span class="nav-badge" id="newsBadge"></span>
        </a>
        <a href="https://col1688888-star.github.io/T-PACHIN/about.html" class="nav-item" id="nav-user" data-page="user">
            <i class="fa fa-user text-xl"></i>
            <span class="text-xs mt-1">æˆ‘çš„</span>
        </a>
    </div>
</nav>

    <script>
        (function() {
            // ===== æ ¸å¿ƒæ•¸æ“šæ¨¡å‹ =====
            const recharge = 3000;
            const bonus = 2000;
            const game = 1740;
            const totalSource = recharge + bonus + game; // 6740
            
            // å¹³å°äº¤æ˜“è¨˜éŒ„
            const correctedTransactions = [
                { date: '2025-02-17 09:05', machine: 'èŠ±æœˆ', impact: -200, type: 'out' },
                { date: '2025-02-17 10:05', machine: 'èŠ±æœˆ', impact: 300, type: 'in' },
                { date: '2025-02-18 22:10', machine: 'å‰å®—', impact: 150, type: 'in' },
                { date: '2025-02-19 09:20', machine: 'è¶…ç´šå¥‡è¹Ÿå°ä¸‘', impact: -500, type: 'out' },
                { date: '2025-02-20 13:45', machine: 'ç”²è³€å¿æ³•å¸–', impact: 80, type: 'in' },
                { date: '2025-02-16 14:30', machine: 'æ–°ç”²è³€', impact: -1000, type: 'out' },
                { date: '2025-02-15 20:15', machine: 'èŠ±æœˆ', impact: 200, type: 'in' },
                { date: '2025-01-25 11:30', machine: 'å‰å®—', impact: -300, type: 'out' },
                { date: '2025-03-01 14:20', machine: 'ç”²è³€å¿æ³•å¸–', impact: 50, type: 'in' },
                { date: '2025-03-02 10:30', machine: 'æ–°ç”²è³€', impact: -150, type: 'out' },
                { date: '2025-03-03 15:45', machine: 'èŠ±æœˆ', impact: 400, type: 'in' },
                { date: '2025-03-04 09:20', machine: 'å‰å®—', impact: -80, type: 'out' },
                { date: '2025-03-05 14:10', machine: 'è¶…ç´šå¥‡è¹Ÿå°ä¸‘', impact: 600, type: 'in' } // å¸¶å…¥ +600
            ];

            // è¨ˆç®—ç¸½å¸¶å‡ºå’Œç¸½å¸¶å…¥
            const totalOut = correctedTransactions.filter(t => t.type === 'out').reduce((sum, t) => sum + Math.abs(t.impact), 0);
            const totalIn = correctedTransactions.filter(t => t.type === 'in').reduce((sum, t) => sum + t.impact, 0);
            
            // è¨ˆç®—æ·¨å½±éŸ¿å’Œç•¶å‰ä»£å¹£
            const netImpact = correctedTransactions.reduce((sum, t) => sum + t.impact, 0);
            const currentTokens = totalSource + netImpact;

            // æ›´æ–°UIé¡¯ç¤º
            document.getElementById('rechargeAmount').textContent = recharge.toLocaleString();
            document.getElementById('bonusAmount').textContent = bonus.toLocaleString();
            document.getElementById('gameAmount').textContent = game.toLocaleString();
            document.getElementById('totalSourceDisplay').textContent = totalSource.toLocaleString();
            document.getElementById('currentTokenBalance').textContent = currentTokens.toLocaleString();
            
            // æ›´æ–°å…¬å¼å€å¡Š
            const formulaBox = document.querySelector('.formula-box .formula-highlight');
            if (formulaBox) {
                formulaBox.innerHTML = `ç¸½ç²å¾— ${totalSource.toLocaleString()} + (å¸¶å‡º+ ${totalOut.toLocaleString()}) - (å¸¶å…¥- ${totalIn.toLocaleString()}) = ${currentTokens.toLocaleString()}`;
            }

            // æ”¶è—æ©Ÿå°ã€ä¿ç•™æ©Ÿå°è³‡æ–™
            let favoriteMachines = [
                { id: 1, name: 'ç”²è³€å¿æ³•å¸– å¼', image: 'https://static.wixstatic.com/media/d5e540_e7da9c3f1fb24a2aa9ef8d180a2cf6fa~mv2.png', ratio: '1:2', vendor: 'Sammy' },
                { id: 2, name: 'è¶…ç´šå¥‡è¹Ÿå°ä¸‘', image: 'https://static.wixstatic.com/media/d5e540_1c6cd7d36cc24e47a6b359a1abeb3923~mv2.png', ratio: '1:1', vendor: 'Olympia' },
                { id: 3, name: 'å‰å®—', image: 'https://static.wixstatic.com/media/d5e540_0926089e3da443eebe6bc2ede58f5788~mv2.png', ratio: '1:2', vendor: 'Daito' }
            ];
            
            let keepMachines = [
                { 
                    id: 4, 
                    name: 'èŠ±æœˆ', 
                    image: 'https://static.wixstatic.com/media/d5e540_0926089e3da443eebe6bc2ede58f5788~mv2.png', 
                    ratio: '1:4', 
                    vendor: 'Olympia',
                    endTime: new Date(Date.now() + 2 * 24 * 60 * 60 * 1000)
                },
                { 
                    id: 5, 
                    name: 'æ–°ç”²è³€', 
                    image: 'https://static.wixstatic.com/media/d5e540_e7da9c3f1fb24a2aa9ef8d180a2cf6fa~mv2.png', 
                    ratio: '1:4', 
                    vendor: 'Sammy',
                    endTime: new Date(Date.now() + 5 * 60 * 60 * 1000)
                }
            ];

            // DOM å…ƒç´ 
            const favBtn = document.getElementById('favMachinesBtn');
            const keepBtn = document.getElementById('keepMachinesBtn');
            const favListContainer = document.getElementById('favMachineList');
            const keepListContainer = document.getElementById('keepMachineList');
            const favItemsEl = document.getElementById('favMachineItems');
            const keepItemsEl = document.getElementById('keepMachineItems');
            const favCountEl = document.getElementById('favCount');
            const keepCountEl = document.getElementById('keepCount');
            const favCountDisplay = document.getElementById('favCountDisplay');
            const keepCountDisplay = document.getElementById('keepCountDisplay');

            // å€’æ•¸è¨ˆæ™‚
            function updateCountdowns() {
                const countdownElements = document.querySelectorAll('.countdown-timer[data-endtime]');
                countdownElements.forEach(el => {
                    const endTime = new Date(el.dataset.endtime).getTime();
                    const now = new Date().getTime();
                    const diff = endTime - now;
                    
                    if (diff <= 0) {
                        el.innerHTML = '<i class="fa fa-hourglass-end"></i> å·²åˆ°æœŸ';
                        el.classList.add('warning');
                        return;
                    }
                    
                    const days = Math.floor(diff / (1000 * 60 * 60 * 24));
                    const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                    const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
                    
                    let timeText = '';
                    if (days > 0) timeText = `${days}å¤© ${hours}å°æ™‚`;
                    else if (hours > 0) timeText = `${hours}å°æ™‚ ${minutes}åˆ†`;
                    else timeText = `${minutes}åˆ†`;
                    
                    if (hours === 0 && days === 0) el.classList.add('warning');
                    else el.classList.remove('warning');
                    
                    el.innerHTML = `<i class="fa fa-hourglass-half"></i> å‰©é¤˜ ${timeText}`;
                });
            }

            function formatEndTime(date) {
                return date.toLocaleString('zh-TW', { year:'numeric', month:'2-digit', day:'2-digit', hour:'2-digit', minute:'2-digit' }).replace(/\//g,'/');
            }

            window.playGame = function(machineName) {
                alert(`ğŸ® é€²å…¥éŠæˆ²ï¼š${machineName}\n(ç¤ºç¯„åŠŸèƒ½)`);
            };

            function renderFavoriteMachines() {
                let html = '';
                favoriteMachines.forEach(machine => {
                    html += `
                        <div class="machine-card" data-id="${machine.id}">
                            <img src="${machine.image}" alt="${machine.name}">
                            <div class="machine-info">
                                <div class="machine-name">${machine.name}</div>
                                <div class="machine-meta"><span>${machine.ratio}</span><span>${machine.vendor}</span></div>
                            </div>
                            <div class="machine-actions">
                                <div class="play-btn" onclick="playGame('${machine.name}')"><i class="fa fa-play"></i> é€²å…¥</div>
                                <div class="remove-btn" onclick="removeFavorite(${machine.id})"><i class="fa fa-times"></i></div>
                            </div>
                        </div>
                    `;
                });
                favItemsEl.innerHTML = html || '<div class="text-gray-400 text-sm p-4 text-center">æš«ç„¡æ”¶è—æ©Ÿå°</div>';
                favCountEl.textContent = favoriteMachines.length;
                if (favCountDisplay) favCountDisplay.textContent = favoriteMachines.length;
            }

            function renderKeepMachines() {
                let html = '';
                keepMachines.forEach(machine => {
                    const endDate = new Date(machine.endTime);
                    const endTimeStr = formatEndTime(endDate);
                    
                    html += `
                        <div class="machine-card" data-id="${machine.id}">
                            <img src="${machine.image}" alt="${machine.name}">
                            <div class="machine-info">
                                <div class="machine-name">${machine.name}</div>
                                <div class="machine-meta"><span>${machine.ratio}</span><span>${machine.vendor}</span></div>
                                <div class="countdown-timer" data-endtime="${endDate.toISOString()}"><i class="fa fa-hourglass-half"></i> è¨ˆç®—ä¸­...</div>
                                <div style="font-size: 0.6rem; color: #aaa; margin-top: 2px;">çµæŸæ–¼ ${endTimeStr}</div>
                            </div>
                            <div class="machine-actions">
                                <div class="play-btn" onclick="playGame('${machine.name}')"><i class="fa fa-play"></i> é€²å…¥</div>
                                <div class="remove-btn" onclick="removeKeep(${machine.id})"><i class="fa fa-times"></i></div>
                            </div>
                        </div>
                    `;
                });
                keepItemsEl.innerHTML = html || '<div class="text-gray-400 text-sm p-4 text-center">æš«ç„¡ä¿ç•™æ©Ÿå°</div>';
                keepCountEl.textContent = keepMachines.length;
                if (keepCountDisplay) keepCountDisplay.textContent = keepMachines.length;
                updateCountdowns();
            }

            window.removeFavorite = function(id) {
                favoriteMachines = favoriteMachines.filter(m => m.id !== id);
                renderFavoriteMachines();
                alert('å·²å¾æ”¶è—ç§»é™¤ (ç¤ºç¯„)');
            };
            window.removeKeep = function(id) {
                keepMachines = keepMachines.filter(m => m.id !== id);
                renderKeepMachines();
                alert('å·²å¾ä¿ç•™ç§»é™¤ (ç¤ºç¯„)');
            };

            favBtn.addEventListener('click', (e) => {
                e.stopPropagation();
                const isShowing = favListContainer.classList.contains('show');
                favListContainer.classList.remove('show');
                keepListContainer.classList.remove('show');
                if (!isShowing) favListContainer.classList.add('show');
            });
            keepBtn.addEventListener('click', (e) => {
                e.stopPropagation();
                const isShowing = keepListContainer.classList.contains('show');
                favListContainer.classList.remove('show');
                keepListContainer.classList.remove('show');
                if (!isShowing) {
                    keepListContainer.classList.add('show');
                    updateCountdowns();
                }
            });
            document.addEventListener('click', function(e) {
                if (!favBtn.contains(e.target) && !keepBtn.contains(e.target) && 
                    !favListContainer.contains(e.target) && !keepListContainer.contains(e.target)) {
                    favListContainer.classList.remove('show');
                    keepListContainer.classList.remove('show');
                }
            });
            setInterval(() => { if (keepListContainer.classList.contains('show')) updateCountdowns(); }, 1000);
            renderFavoriteMachines();
            renderKeepMachines();

            // ===== å±•é–‹/æ”¶åˆåŠŸèƒ½ (åƒ…ç”¨æ–¼å…Œæ›ä¾†æºå’Œæ³¨å–®) =====
            function setupToggle(btnId, sectionId) {
                const btn = document.getElementById(btnId);
                const section = document.getElementById(sectionId);
                if (btn && section) {
                    btn.addEventListener('click', (e) => {
                        e.stopPropagation();
                        btn.classList.toggle('collapsed');
                        section.classList.toggle('collapsed');
                    });
                }
            }
            
            setupToggle('toggleRecharge', 'rechargeDetails');
            setupToggle('toggleBonus', 'bonusDetails');
            setupToggle('toggleGame', 'gameDetails');
            setupToggle('toggleBetBtn', 'betSection');

            // ===== å¹³å°åˆ—è¡¨æ¸²æŸ“ + é»æ“Šå±•é–‹æ˜ç´° =====
            const ITEMS_PER_PAGE = 5;
            let currentPlatformPage = 1;
            let filteredPlatformTransactions = [];

            // å„²å­˜ç•¶å‰å±•é–‹çš„è¨˜éŒ„ID (ä½¿ç”¨ç´¢å¼•)
            let expandedIndex = null;

            function togglePlatformDetail(index) {
                if (expandedIndex === index) {
                    expandedIndex = null; // æ”¶åˆ
                } else {
                    expandedIndex = index; // å±•é–‹æ–°çš„
                }
                renderPlatformList(); // é‡æ–°æ¸²æŸ“
            }

            function renderPlatformList() {
                const filterType = document.getElementById('platformFilter').value;
                const startDate = new Date(document.getElementById('startDateFilter').value);
                const endDate = new Date(document.getElementById('endDateFilter').value);
                endDate.setHours(23, 59, 59, 999);

                filteredPlatformTransactions = correctedTransactions.filter(t => {
                    const tDate = new Date(t.date.split(' ')[0]);
                    if (tDate < startDate || tDate > endDate) return false;
                    if (filterType === 'out') return t.type === 'out';
                    if (filterType === 'in') return t.type === 'in';
                    return true;
                });

                filteredPlatformTransactions.sort((a,b) => new Date(b.date) - new Date(a.date));
                
                const allSorted = [...correctedTransactions].sort((a,b) => new Date(a.date) - new Date(b.date));
                let balanceMap = new Map();
                let runningBalance = totalSource;
                for (let i = 0; i < allSorted.length; i++) {
                    const trans = allSorted[i];
                    const key = trans.date + trans.machine + trans.impact;
                    balanceMap.set(key, runningBalance);
                    runningBalance += trans.impact;
                }
                
                const totalPages = Math.ceil(filteredPlatformTransactions.length / ITEMS_PER_PAGE) || 1;
                if (currentPlatformPage > totalPages) currentPlatformPage = totalPages;
                
                const startIdx = (currentPlatformPage - 1) * ITEMS_PER_PAGE;
                const pageItems = filteredPlatformTransactions.slice(startIdx, startIdx + ITEMS_PER_PAGE);
                
                const listContainer = document.getElementById('platformList');
                let html = '';
                
                pageItems.forEach((t, idx) => {
                    const globalIndex = startIdx + idx; // å…¨åŸŸç´¢å¼•
                    const tagClass = t.type === 'out' ? 'platform-tag out' : 'platform-tag in';
                    const tagText = t.type === 'out' ? 'å¸¶å‡º' : 'å¸¶å…¥';
                    const amountClass = t.type === 'in' ? 'text-green-400' : 'text-red-400';
                    const amountSign = t.type === 'in' ? `+${t.impact}` : `-${Math.abs(t.impact)}`;
                    const key = t.date + t.machine + t.impact;
                    const prevBal = balanceMap.get(key) || totalSource;
                    const afterBal = prevBal + t.impact;
                    
                    const isExpanded = (expandedIndex === globalIndex);
                    const expandedClass = isExpanded ? 'expanded' : '';
                    
                    html += `
                        <div class="platform-item ${expandedClass}" onclick="togglePlatformDetail(${globalIndex})">
                            <div class="platform-left">
                                <span class="${tagClass}">${tagText}</span>
                                <span class="text-blue-200">${t.date}</span>
                                <span class="platform-machine">${t.machine}</span>
                            </div>
                            <span class="platform-amount ${amountClass}">${amountSign}</span>
                            <span class="detail-icon"><i class="fa fa-chevron-right chevron-icon"></i></span>
                        </div>
                        <div class="platform-detail" id="detail-${globalIndex}" style="${isExpanded ? 'display: block;' : 'display: none;'}">
                            <div class="platform-detail-row">
                                <span class="platform-detail-label">åŸèº«ä¸Šä»£å¹£ï¼š</span>
                                <span class="platform-detail-value">${prevBal.toLocaleString()}</span>
                            </div>
                            <div class="platform-detail-row">
                                <span class="platform-detail-label">äº¤æ˜“è®Šå‹•ï¼š</span>
                                <span class="platform-detail-change ${t.type === 'in' ? 'positive' : 'negative'}">${t.type === 'in' ? '+' : '-'}${Math.abs(t.impact)}</span>
                            </div>
                            <div class="platform-detail-row">
                                <span class="platform-detail-label">ç•¶å‰èº«ä¸Šä»£å¹£ï¼š</span>
                                <span class="platform-detail-value">${afterBal.toLocaleString()}</span>
                            </div>
                        </div>
                    `;
                });
                
                listContainer.innerHTML = html || '<div class="text-gray-400 text-sm p-2 text-center">ç„¡ç¬¦åˆè¨˜éŒ„</div>';
                
                renderPlatformPagination(totalPages);
            }

            function renderPlatformPagination(totalPages) {
                const paginationContainer = document.getElementById('platformPagination');
                let btns = '';
                for (let i = 1; i <= totalPages; i++) {
                    btns += `<span class="page-btn ${i === currentPlatformPage ? 'active' : ''}" data-platform-page="${i}">${i}</span>`;
                }
                paginationContainer.innerHTML = btns;
                
                document.querySelectorAll('[data-platform-page]').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        e.preventDefault();
                        currentPlatformPage = parseInt(e.target.dataset.platformPage);
                        expandedIndex = null; // æ›é æ™‚æ”¶èµ·æ‰€æœ‰å±•é–‹
                        renderPlatformList();
                    });
                });
            }

            // å®šç¾©å…¨åŸŸå‡½æ•¸ä¾› onclick ä½¿ç”¨
            window.togglePlatformDetail = function(index) {
                if (expandedIndex === index) {
                    expandedIndex = null;
                } else {
                    expandedIndex = index;
                }
                renderPlatformList();
            };

            // å­æ¨™ç±¤åˆ‡æ›
            const exchangeSub = document.getElementById('tokenExchangeSub');
            const platformSub = document.getElementById('tokenPlatformSub');
            const exchangeContent = document.getElementById('exchangeContent');
            const platformContent = document.getElementById('platformContent');
            
            if (exchangeSub && platformSub) {
                exchangeSub.addEventListener('click', () => {
                    exchangeSub.classList.add('active');
                    platformSub.classList.remove('active');
                    exchangeContent.classList.remove('hidden');
                    platformContent.classList.add('hidden');
                });
                platformSub.addEventListener('click', () => {
                    platformSub.classList.add('active');
                    exchangeSub.classList.remove('active');
                    platformContent.classList.remove('hidden');
                    exchangeContent.classList.add('hidden');
                    
                    const today = new Date();
                    const threeMonthsAgo = new Date();
                    threeMonthsAgo.setDate(today.getDate() - 90);
                    document.getElementById('startDateFilter').value = threeMonthsAgo.toISOString().split('T')[0];
                    document.getElementById('endDateFilter').value = today.toISOString().split('T')[0];
                    
                    currentPlatformPage = 1;
                    expandedIndex = null;
                    renderPlatformList();
                });
            }

            document.getElementById('platformFilter')?.addEventListener('change', () => {
                currentPlatformPage = 1;
                expandedIndex = null;
                renderPlatformList();
            });
            document.getElementById('startDateFilter')?.addEventListener('change', () => {
                currentPlatformPage = 1;
                expandedIndex = null;
                renderPlatformList();
            });
            document.getElementById('endDateFilter')?.addEventListener('change', () => {
                currentPlatformPage = 1;
                expandedIndex = null;
                renderPlatformList();
            });

            // æ³¨å–®åˆ†é 
            const betPages = {
                1: [
                    { id: 'BB20250221-001', machine: 'ç”²è³€å¿æ³•å¸–', amount: '+1,200', amountClass: 'text-amber-400' },
                    { id: 'BB20250220-045', machine: 'è¶…ç´šå¥‡è¹Ÿå°ä¸‘', amount: '-500', amountClass: 'text-red-400' },
                    { id: 'BB20250219-112', machine: 'å‰å®—', amount: '+3,200', amountClass: 'text-amber-400' }
                ],
                2: [
                    { id: 'BB20250218-089', machine: 'èŠ±æœˆ', amount: '+800', amountClass: 'text-amber-400' },
                    { id: 'BB20250217-033', machine: 'æ–°ç”²è³€', amount: '+2,100', amountClass: 'text-amber-400' },
                    { id: 'BB20250216-077', machine: 'ç”²è³€å¿æ³•å¸–', amount: '-150', amountClass: 'text-red-400' }
                ],
                3: [
                    { id: 'BB20250215-120', machine: 'è¶…ç´šå¥‡è¹Ÿå°ä¸‘', amount: '+4,500', amountClass: 'text-amber-400' },
                    { id: 'BB20250214-056', machine: 'å‰å®—', amount: '-300', amountClass: 'text-red-400' },
                    { id: 'BB20250213-099', machine: 'èŠ±æœˆ', amount: '+1,050', amountClass: 'text-amber-400' },
                    { id: 'BB20250212-222', machine: 'æ–°ç”²è³€', amount: '+600', amountClass: 'text-amber-400' }
                ]
            };
            
            const betContainer = document.getElementById('betListContainer');
            const betPageBtns = document.querySelectorAll('#betPagination .page-btn');
            
            function renderBetPage(page) {
                const bets = betPages[page] || [];
                let html = '';
                bets.forEach(b => {
                    html += `
                        <div class="flex justify-between items-center border-b border-blue-900 pb-1">
                            <span class="bet-id">#${b.id}</span>
                            <span class="text-xs text-blue-300">${b.machine}</span>
                            <span class="${b.amountClass}">${b.amount}</span>
                            <span class="detail-bb" onclick="alert('ğŸ¬ æ’­æ”¾BBå½±ç‰‡ (ç¤ºç¯„)  \\næ³¨å–®è™Ÿ: ${b.id}')">ğŸ“½ï¸ è©³ç´°</span>
                        </div>
                    `;
                });
                betContainer.innerHTML = html;
                
                betPageBtns.forEach(btn => {
                    btn.classList.remove('active');
                    if (btn.dataset.page == page) btn.classList.add('active');
                });
            }

            betPageBtns.forEach(btn => {
                btn.addEventListener('click', (e) => {
                    e.preventDefault();
                    const page = e.target.dataset.page;
                    if (page) renderBetPage(parseInt(page));
                });
            });
            renderBetPage(1);

            // å…¶ä»–åŠŸèƒ½
            const closeBtn = document.getElementById('closeDrawer');
            const overlay = document.getElementById('drawerOverlay');
            if(closeBtn) closeBtn.addEventListener('click', ()=> {
                document.getElementById('filterDrawer')?.classList.remove('open');
                overlay?.classList.remove('open');
            });
            if(overlay) overlay.addEventListener('click', ()=> {
                document.getElementById('filterDrawer')?.classList.remove('open');
                overlay.classList.remove('open');
            });

            const avatarImg = document.getElementById('avatarImage');
            const avatarContainer = document.getElementById('avatarContainer');
            const avatars = ['https://i.pravatar.cc/150?img=7','https://i.pravatar.cc/150?img=5','https://i.pravatar.cc/150?img=9','https://i.pravatar.cc/150?img=12'];
            let idx = 0;
            avatarContainer.addEventListener('click', ()=>{
                idx = (idx+1)%avatars.length;
                avatarImg.src = avatars[idx];
                alert('å¤§é ­ç…§å·²æ›´æ› (ç¤ºç¯„)');
            });

            const displayName = document.getElementById('displayNickname');
            let currentName = 'å¤«äººæœƒç”Ÿæ°£';
            displayName.addEventListener('click', ()=>{
                let newName = prompt('ä¿®æ”¹æš±ç¨±', currentName);
                if(newName && newName.trim()) {
                    currentName = newName.trim();
                    displayName.textContent = currentName;
                }
            });

            document.getElementById('exitToHomeBtn').addEventListener('click', (e)=>{
                e.preventDefault();
                alert('è¿”å›é¦–é  (ç¤ºç¯„)');
            });
            document.getElementById('supportBtn').addEventListener('click', ()=> alert('ğŸ“ å®¢æœèˆ‡å¹«åŠ© (ç¤ºç¯„)'));
            document.getElementById('languageSelect').addEventListener('change', function(e){
                alert(`èªè¨€åˆ‡æ›è‡³ï¼š${this.options[this.selectedIndex].text} (ç¤ºç¯„)`);
            });

            const themeToggle = document.getElementById('themeToggle');
            const body = document.body;
            if(localStorage.getItem('theme')==='dark') body.classList.add('dark-mode');
            themeToggle.addEventListener('click', ()=>{
                body.classList.toggle('dark-mode');
                localStorage.setItem('theme', body.classList.contains('dark-mode') ? 'dark' : 'light');
            });

            const vipPanel = document.getElementById('vipInfoPanel');
            const vipBadge = document.getElementById('vipBadge');
            const expText = document.getElementById('expText');
            function toggleVipPanel(e) {
                e.stopPropagation();
                vipPanel.classList.toggle('show');
            }
            vipBadge.addEventListener('click', toggleVipPanel);
            expText.addEventListener('click', toggleVipPanel);
            document.addEventListener('click', function(e) {
                if (!vipPanel.contains(e.target) && !vipBadge.contains(e.target) && !expText.contains(e.target)) {
                    vipPanel.classList.remove('show');
                }
            });

            const tabs = document.querySelectorAll('.profile-tab');
            const panels = {
                settings: document.getElementById('settingsPanel'),
                token: document.getElementById('tokenPanel'),
                betHistory: document.getElementById('betHistoryPanel')
            };
            tabs.forEach(tab => {
                tab.addEventListener('click', (e)=>{
                    e.preventDefault();
                    const tabId = tab.dataset.tab;
                    tabs.forEach(t=>t.classList.remove('active'));
                    tab.classList.add('active');
                    Object.keys(panels).forEach(key => panels[key].classList.add('hidden'));
                    if(panels[tabId]) panels[tabId].classList.remove('hidden');
                });
            });

            // å°èˆªç¤ºç¯„åŠŸèƒ½å·²ç§»é™¤ - ç¾åœ¨å¯ä»¥æ­£å¸¸é€£çµäº†ï¼
        })();
    </script>
  <!-- â­ å¼•å…¥ shared.js â­ -->
    <script src="shared.js"></script>
</body>
</html>
